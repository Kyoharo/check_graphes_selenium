#graphes_links 
Live_session = {
'AppSrv01_live_session':'https://presentation.egyptpost.local/#/monitors/501948+295968/1/perfOverviewTab',
'AppSrv02_live_session':'https://presentation.egyptpost.local/#/monitors/501948+296299/1/perfOverviewTab',
'AppSrv03_live_session':'https://presentation.egyptpost.local/#/monitors/501948+296660/1/perfOverviewTab',
'AppSrv04_live_session':'https://presentation.egyptpost.local/#/monitors/501948+296798/1/perfOverviewTab',
'AppSrv05_live_session':'https://presentation.egyptpost.local/#/monitors/501948+296295/1/perfOverviewTab',
'AppSrv06_live_session':'https://presentation.egyptpost.local/#/monitors/501948+296411/1/perfOverviewTab'
}

Availability = {
'AppSrv01_Availability':'https://presentation.egyptpost.local/#/monitors/501988+139310/1/perfOverviewTab',
'AppSrv02_Availability':'https://presentation.egyptpost.local/#/monitors/501988+139304/1/perfOverviewTab',
'AppSrv03_Availability':'https://presentation.egyptpost.local/#/monitors/501988+139299/1/perfOverviewTab',
'AppSrv04_Availability':'https://presentation.egyptpost.local/#/monitors/501988+139296/1/perfOverviewTab',
'AppSrv05_Availability':'https://presentation.egyptpost.local/#/monitors/501988+139301/1/perfOverviewTab',
'AppSrv06_Availability':'https://presentation.egyptpost.local/#/monitors/501988+139298/1/perfOverviewTab'
}

Oracle = {
'Appsrv01_Oracle':'https://presentation.egyptpost.local/#/monitors/501940+296087/1/perfOverviewTab',
'Appsrv02_Oracle':'https://presentation.egyptpost.local/#/monitors/501940+296414/1/perfOverviewTab',
'Appsrv03_Oracle':'https://presentation.egyptpost.local/#/monitors/501940+296720/1/perfOverviewTab',
'Appsrv04_Oracle':'https://presentation.egyptpost.local/#/monitors/501940+296038/1/perfOverviewTab',
'Appsrv05_Oracle':'https://presentation.egyptpost.local/#/monitors/501940+296352/1/perfOverviewTab',
'Appsrv06_Oracle':'https://presentation.egyptpost.local/#/monitors/501940+296566/1/perfOverviewTab'
}


Thread_Pool = {
'Appsrv01_Thread_Pool':'https://presentation.egyptpost.local/#/monitors/501930+296103/1/perfOverviewTab',
'Appsrv02_Thread_Pool':'https://presentation.egyptpost.local/#/monitors/501930+296339/1/perfOverviewTab',
'Appsrv03_Thread_Pool':'https://presentation.egyptpost.local/#/monitors/501930+296684/1/perfOverviewTab',
'Appsrv04_Thread_Pool':'https://presentation.egyptpost.local/#/monitors/501930+295877/1/perfOverviewTab',
'Appsrv05_Thread_Pool':'https://presentation.egyptpost.local/#/monitors/501930+296185/1/perfOverviewTab',
'Appsrv06_Thread_Pool':'https://presentation.egyptpost.local/#/monitors/501930+296467/1/perfOverviewTab'
}

Memory = {
'Appsrv01_Memory':'https://presentation.egyptpost.local/#/monitors/501978+296154/1/perfOverviewTab',
'Appsrv02_Memory':'https://presentation.egyptpost.local/#/monitors/501978+296426/1/perfOverviewTab',
'Appsrv03_Memory':'https://presentation.egyptpost.local/#/monitors/501978+296725/1/perfOverviewTab',
'Appsrv04_Memory':'https://presentation.egyptpost.local/#/monitors/501978+296044/1/perfOverviewTab',
'Appsrv05_Memory':'https://presentation.egyptpost.local/#/monitors/501978+296241/1/perfOverviewTab',
'Appsrv06_Memory':'https://presentation.egyptpost.local/#/monitors/501978+296617/1/perfOverviewTab'
}

exchange = {
'ep-ex-smart-01_EXCHANGE':'https://presentation.egyptpost.local/#/monitors/501024+275227/1/perfOverviewTab',
'ep-maadi-mbx9_EXCHANGE':'https://presentation.egyptpost.local/#/monitors/501024+47371/1/perfOverviewTab',
'ep-ex-cas1_EXCHANGE':'https://presentation.egyptpost.local/#/monitors/501024+151266/1/perfOverviewTab',
'ep-ex-cas8_EXCHANGE':'https://presentation.egyptpost.local/#/monitors/501024+455646/1/perfOverviewTab',
'ep-ex-cas6_EXCHANGE':'https://presentation.egyptpost.local/#/monitors/501024+46950/1/perfOverviewTab'
}

frontoffice = {
'FrontOffice_054_FrontOffice_LoginStatus':'https://presentation.egyptpost.local/#/monitors/501566+287661/1/perfOverviewTab',
'p-fo-03-13-0_FrontOffice_LoginStatus':'https://presentation.egyptpost.local/#/monitors/501566+287639/1/perfOverviewTab',
'P-FO-03-14_FrontOffice_LoginStatus':'https://presentation.egyptpost.local/#/monitors/501566+287625/1/perfOverviewTab',
'FrontOffice_015_FrontOffice_LoginStatus':'https://presentation.egyptpost.local/#/monitors/501566+287611/1/perfOverviewTab',
'FrontOffice_010_FrontOffice_LoginStatus':'https://presentation.egyptpost.local/#/monitors/501566+287594/1/perfOverviewTab'
}

recverence =  '''
---------------------------------------<br>
REVERENCE:<br>
=============<br>
Live Session:<br>
    To: Wehad-Ahmed@EgyptPost.Org ; amr.bishry@EgyptPost.Org ; Nizar.Yousri@EgyptPost.Org ;<br> 
<br>
Availability:<br>
    To: Wehad-Ahmed@EgyptPost.Org ; amr.bishry@EgyptPost.Org ; Nizar.Yousri@EgyptPost.Org ;<br> 
<br>
Oracle      :<br>
    To: db_admin@EgyptPost.Org ;  Sara.bashandi@EgyptPost.Org ; Wehad-Ahmed@EgyptPost.Org<br> 
<br>
Thread Pool :<br>
    To: Wehad-Ahmed@EgyptPost.Org ; amr.bishry@EgyptPost.Org ; Nizar.Yousri@EgyptPost.Org ;<br> 
<br>
Memory&Heap :<br>
    To: Wehad-Ahmed@EgyptPost.Org ; amr.bishry@EgyptPost.Org ; Nizar.Yousri@EgyptPost.Org ;<br> 
<br>
Exchange :<br>
    To: Eman.madbouly@egyptpost.org ; abdelmonem@egyptpost.org ; melsaid@EgyptPost.Org ; Hisham_gaber@EgyptPost.Org; <br> 
<br>
FrontOffice :<br>
    To: Ataha@egyptpost.org ; postal-support@EgyptPost.Org ; ehab_hussein@EgyptPost.Org ;<br> 
<br>
CC: Alnasser.mohamed@EgyptPost.Org ; W_SOC_TEAM@EgyptPost.Org ; SOC_supervisors@EgyptPost.Org<br>
---------------------------------------<br>
'''     

import os
import smtplib
from email.message import EmailMessage

def send_email(body_message, folder_path):
    # Email configuration
    smtp_host = 'mail.egyptpost.org'
    smtp_port = 25  # Update the port if necessary
    sender_email = 'W_Abdelrahman.Ataa@EgyptPost.Org'
    recipient_emails = ['W_Abdelrahman.Ataa@EgyptPost.Org',
                         'w_soc_team@egyptpost.org',
                         'SOC_supervisors@EgyptPost.Org']
    subject = 'Graphs status'

    # Create the email message
    message = EmailMessage()
    message.set_content(body_message, subtype='html')
    message['Subject'] = subject
    message['From'] = sender_email
    message['To'] = ', '.join(recipient_emails)

    # Attach images from the specified folder if it's not empty
    if os.listdir(folder_path):
        for filename in os.listdir(folder_path):
            if filename.endswith('.jpg') or filename.endswith('.png'):  # Add more extensions if needed
                image_path = os.path.join(folder_path, filename)
                with open(image_path, 'rb') as image_file:
                    image_data = image_file.read()
                    image_type = filename.split('.')[-1]  # Get the file extension
                    message.add_attachment(image_data, maintype='image', subtype=image_type, filename=filename)

    # Create the SMTP connection
    with smtplib.SMTP(smtp_host, smtp_port) as server:
        server.set_debuglevel(1)  # Enable debug output for troubleshooting
        server.ehlo()
        server.sendmail(sender_email, recipient_emails, message.as_string())

